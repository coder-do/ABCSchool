@page "/role-permissions/{RoleId}"

<Header OnReturn="Cancel" Title="@_title" Description="@_description" />

@if (_isLoading)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
}
else
{
    <MudTabs Elevation="25" Rounded="true" Centered="true" ApplyEffectsToContainer="true" AlwaysShowScrollButtons="true">
        @foreach (var group in RoleClaimsGroup.Keys)
        {
            var assignedRoleClaimsInGroup = RoleClaimsGroup[group].Where(rcvm => rcvm.IsSelected).ToList();
            var allRoleClaimsInGroup = RoleClaimsGroup[group].ToList();

            <MudTabPanel Text="@group" BadgeData="@($"{assignedRoleClaimsInGroup.Count}/{allRoleClaimsInGroup.Count}")"
                         Style="padding-right: 42px;" BadgeColor="@GetGroupBadgeColor(assignedRoleClaimsInGroup.Count, allRoleClaimsInGroup.Count)">
                <MudTable Items="@allRoleClaimsInGroup"
                          Style="margin-button: 0px!important"
                          Elevation="25">
                    <ToolBarContent>
                        @if (_canUpdateRolePermission)
                        {
                            <MudButton OnClick="UpdateRolePermissionsAsync" Variant="Variant.Filled" Color="Color.Primary">Update Permissions</MudButton>
                        }
                    </ToolBarContent>
                    <HeaderContent>
                        <MudTh>Name</MudTh>
                        <MudTh>Description</MudTh>
                        <MudTh>Is Selected</MudTh>
                    </HeaderContent>
                    <RowTemplate>
                        <MudTd DataLabel="Name"> @context.Name</MudTd>
                        <MudTd DataLabel="Description"> @context.Description</MudTd>
                        <MudTd DataLabel="Is Active">
                            <MudCheckBox @bind-Value="@context.IsSelected"
                                         Color="Color.Secondary" />
                        </MudTd>
                    </RowTemplate>
                    <PagerContent>
                        <MudTablePager RowsPerPageString="RowsPerPageString" InfoFormat="InfoFormat" />
                    </PagerContent>
                </MudTable>
            </MudTabPanel>
        }
    </MudTabs>
}
